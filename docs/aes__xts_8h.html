<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libzpc: zpc/aes_xts.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libzpc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">IBM Z Protected-key Crypto library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f917d4082cd055ef81802047648c24.html">zpc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">aes_xts.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>AES-XTS API.  
<a href="#details">More...</a></p>

<p><a href="aes__xts_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae472bf5116212c3c408479947203ca9e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#ae472bf5116212c3c408479947203ca9e">zpc_aes_xts_alloc</a> (struct zpc_aes_xts **ctx)</td></tr>
<tr class="separator:ae472bf5116212c3c408479947203ca9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42519949a56916640253856ea9d6e38b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#a42519949a56916640253856ea9d6e38b">zpc_aes_xts_set_key</a> (struct zpc_aes_xts *ctx, struct zpc_aes_key *key1, struct zpc_aes_key *key2)</td></tr>
<tr class="separator:a42519949a56916640253856ea9d6e38b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50dbea53e0757fae25fe824e0816d713"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#a50dbea53e0757fae25fe824e0816d713">zpc_aes_xts_set_iv</a> (struct zpc_aes_xts *ctx, const unsigned char *iv)</td></tr>
<tr class="separator:a50dbea53e0757fae25fe824e0816d713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c056c7f31d915807b5282fb6d08fb5e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#a0c056c7f31d915807b5282fb6d08fb5e">zpc_aes_xts_encrypt</a> (struct zpc_aes_xts *ctx, unsigned char *ct, const unsigned char *pt, size_t ptlen)</td></tr>
<tr class="separator:a0c056c7f31d915807b5282fb6d08fb5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a955b600a547b79318fce27686618e09e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#a955b600a547b79318fce27686618e09e">zpc_aes_xts_decrypt</a> (struct zpc_aes_xts *ctx, unsigned char *pt, const unsigned char *ct, size_t ctlen)</td></tr>
<tr class="separator:a955b600a547b79318fce27686618e09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36eeaa37424136a1bdad4e36b9553428"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__xts_8h.html#a36eeaa37424136a1bdad4e36b9553428">zpc_aes_xts_free</a> (struct zpc_aes_xts **ctx)</td></tr>
<tr class="separator:a36eeaa37424136a1bdad4e36b9553428"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>AES-XTS API. </p>
<p>Encryption API for the Advanced Encryption Standard (AES) block cipher <a class="el" href="citelist.html#CITEREF_AES">[1]</a> in XEX-based Tweaked-codebook mode with ciphertext Stealing (XTS) mode of operation <a class="el" href="citelist.html#CITEREF_XTS">[6]</a> .</p>
<p>The context of a AES-XTS operation is stored in objects of type struct zpc_aes_xts. Context objects must not be shared among multiple threads. Context objects may be used for multiple operations by (re)setting the key. </p>

<p class="definition">Definition in file <a class="el" href="aes__xts_8h_source.html">aes_xts.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae472bf5116212c3c408479947203ca9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae472bf5116212c3c408479947203ca9e">&#9670;&nbsp;</a></span>zpc_aes_xts_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_xts_alloc </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new context object for an AES-XTS operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a42519949a56916640253856ea9d6e38b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42519949a56916640253856ea9d6e38b">&#9670;&nbsp;</a></span>zpc_aes_xts_set_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_xts_set_key </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the key to be used in the context of an AES-XTS operation.</p>
<p>If a key is already set, the reference count of that key object is decremented. The context's key reference is set to the key object argument. If the key object argument is non-NULL, the reference count of that key object is incremented.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key1</td><td>first AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key2</td><td>second AES key object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a50dbea53e0757fae25fe824e0816d713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50dbea53e0757fae25fe824e0816d713">&#9670;&nbsp;</a></span>zpc_aes_xts_set_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_xts_set_iv </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the initialization vector to be used in the context of an AES-XTS operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>16 byte initialization vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a0c056c7f31d915807b5282fb6d08fb5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c056c7f31d915807b5282fb6d08fb5e">&#9670;&nbsp;</a></span>zpc_aes_xts_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_xts_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ptlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt a plaintext using AES-XTS to obtain the corresponding ciphertext.</p>
<p>The ciphertext buffer must be large enough to store the resulting ciphertext which has the same length as the (padded) plaintext.</p>
<p>Plaintext and ciphertext buffer may be equal such that the operation is done in-place. If the operation is not done in-place, plaintext and ciphertext buffers must not overlap.</p>
<p>A plaintext may be encrypted chunkwise. For every operation on a plaintext chunk, the same rules apply as for the one-shot encryption. All chunk-lengths except the final one must be a multiple of 16 bytes. The same context object must be used to encrypt all chunks without modifying it in between operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ct</td><td>ciphertext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pt</td><td>plaintext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptlen</td><td>plaintext length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a955b600a547b79318fce27686618e09e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a955b600a547b79318fce27686618e09e">&#9670;&nbsp;</a></span>zpc_aes_xts_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_xts_decrypt </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ctlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt a ciphertext using AES-XTS to obtain the corresponding plaintext.</p>
<p>The plaintext buffer must be large enough to store the resulting plaintext which has the same length as the ciphertext.</p>
<p>Plaintext and ciphertext buffer may be equal such that the operation is done in-place. If the operation is not done in-place, plaintext and ciphertext buffers must not overlap.</p>
<p>A ciphertext may be decrypted chunkwise. For every operation on a ciphertext chunk, the same rules apply as for the one-shot decryption. All chunk-lengths except the final one must be a multiple of 16 bytes. The same context object must be used to decrypt all chunks without modifying it in between operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pt</td><td>plaintext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ct</td><td>ciphertext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctlen</td><td>ciphertext length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a36eeaa37424136a1bdad4e36b9553428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36eeaa37424136a1bdad4e36b9553428">&#9670;&nbsp;</a></span>zpc_aes_xts_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zpc_aes_xts_free </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_xts **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free an AES-XTS context object.</p>
<p>If a key is set, the reference count of that key object is decremented. The context object argument is set to NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-XTS context object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
