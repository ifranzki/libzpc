<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libzpc: zpc/aes_key.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libzpc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">IBM Z Protected-key Crypto library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f917d4082cd055ef81802047648c24.html">zpc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">aes_key.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>AES key API.  
<a href="#details">More...</a></p>

<p><a href="aes__key_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad92ed3c89eb99543cb3408a09642a903"><td class="memItemLeft" align="right" valign="top"><a id="ad92ed3c89eb99543cb3408a09642a903"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ZPC_AES_KEY_TYPE_CCA_DATA</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad92ed3c89eb99543cb3408a09642a903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a9f9d3e04fc1af5fa585b0d250b07c"><td class="memItemLeft" align="right" valign="top"><a id="aa5a9f9d3e04fc1af5fa585b0d250b07c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ZPC_AES_KEY_TYPE_CCA_CIPHER</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa5a9f9d3e04fc1af5fa585b0d250b07c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab710f37a62fc171c87b88aca65089c8b"><td class="memItemLeft" align="right" valign="top"><a id="ab710f37a62fc171c87b88aca65089c8b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ZPC_AES_KEY_TYPE_EP11</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ab710f37a62fc171c87b88aca65089c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51efa8d1ea4c8d626d6d839b487ca23"><td class="memItemLeft" align="right" valign="top"><a id="ae51efa8d1ea4c8d626d6d839b487ca23"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ZPC_AES_KEY_REENCIPHER_OLD_TO_CURRENT</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ae51efa8d1ea4c8d626d6d839b487ca23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dbe1e7ed2cdf652ab9a0ac03fe8942e"><td class="memItemLeft" align="right" valign="top"><a id="a6dbe1e7ed2cdf652ab9a0ac03fe8942e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ZPC_AES_KEY_REENCIPHER_CURRENT_TO_NEW</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a6dbe1e7ed2cdf652ab9a0ac03fe8942e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a060807b5c1a43188e0cd2b1c2548ef33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a060807b5c1a43188e0cd2b1c2548ef33">zpc_aes_key_alloc</a> (struct zpc_aes_key **key)</td></tr>
<tr class="separator:a060807b5c1a43188e0cd2b1c2548ef33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bc19039829832313f84217ddbc12370"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a7bc19039829832313f84217ddbc12370">zpc_aes_key_set_size</a> (struct zpc_aes_key *key, int size)</td></tr>
<tr class="separator:a7bc19039829832313f84217ddbc12370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab53433c4091276a2324860144dfbe86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#aab53433c4091276a2324860144dfbe86">zpc_aes_key_set_type</a> (struct zpc_aes_key *key, int type)</td></tr>
<tr class="separator:aab53433c4091276a2324860144dfbe86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a700366ec1d545c1264c3290b77656f3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a700366ec1d545c1264c3290b77656f3c">zpc_aes_key_set_flags</a> (struct zpc_aes_key *key, unsigned int flags)</td></tr>
<tr class="separator:a700366ec1d545c1264c3290b77656f3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd77ac0413bfdd1a53806ee9d029e54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a2bd77ac0413bfdd1a53806ee9d029e54">zpc_aes_key_set_mkvp</a> (struct zpc_aes_key *key, const char *mkvp)</td></tr>
<tr class="separator:a2bd77ac0413bfdd1a53806ee9d029e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a586a8189aa3fbc55163080dbdc874fc3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a586a8189aa3fbc55163080dbdc874fc3">zpc_aes_key_set_apqns</a> (struct zpc_aes_key *key, const char *apqns[])</td></tr>
<tr class="separator:a586a8189aa3fbc55163080dbdc874fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6148f9aeabe72be78ecbef205c0f04fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a6148f9aeabe72be78ecbef205c0f04fb">zpc_aes_key_import</a> (struct zpc_aes_key *key, const unsigned char *seckey, size_t seckeylen)</td></tr>
<tr class="separator:a6148f9aeabe72be78ecbef205c0f04fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64327ae37920bc387bbddc844a726015"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a64327ae37920bc387bbddc844a726015">zpc_aes_key_import_clear</a> (struct zpc_aes_key *key, const unsigned char *clrkey)</td></tr>
<tr class="separator:a64327ae37920bc387bbddc844a726015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317025b1b138b377abb13c64a43e8beb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a317025b1b138b377abb13c64a43e8beb">zpc_aes_key_export</a> (struct zpc_aes_key *key, unsigned char *seckey, size_t *seckeylen)</td></tr>
<tr class="separator:a317025b1b138b377abb13c64a43e8beb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601fb4f7adbaaf3652d672b54753d91d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a601fb4f7adbaaf3652d672b54753d91d">zpc_aes_key_generate</a> (struct zpc_aes_key *key)</td></tr>
<tr class="separator:a601fb4f7adbaaf3652d672b54753d91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb5f3ca58ece71be02605ce6759ef84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a9fb5f3ca58ece71be02605ce6759ef84">zpc_aes_key_reencipher</a> (struct zpc_aes_key *key, int reenc)</td></tr>
<tr class="separator:a9fb5f3ca58ece71be02605ce6759ef84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f31fc142e4e83ad7d08b2a454a73fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__key_8h.html#a69f31fc142e4e83ad7d08b2a454a73fa">zpc_aes_key_free</a> (struct zpc_aes_key **key)</td></tr>
<tr class="separator:a69f31fc142e4e83ad7d08b2a454a73fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>AES key API. </p>
<p>Manage advanced Encryption Standard (AES) block cipher <a class="el" href="citelist.html#CITEREF_AES">[1]</a> keys.</p>
<p>AES key objects of type struct zpc_aes_key store a secure AES key of size 128, 192 or 256 bits and of type ZPC_AES_KEY_TYPE_CCA_DATA, ZPC_AES_KEY_TYPE_CCA_CIPHER or ZPC_AES_KEY_TYPE_EP11, flags, a reference count and the corresponding protected key.</p>
<p>Setting flags is optional for AES key objects and flags=0 if flags are not explicitely set.</p>
<p>The secure key is set by either generating it or importing it (either directly or from a clear key).</p>
<p>The protected is automatically derived from the secure key (and re-dervided whenever it is needed).</p>
<p>The protected key can also be randomly generated resulting in a protected key that is not associated to any secure key. Key objects that are not associated to a secure key become unusable when the WKVP changes.</p>
<p>Key object's reference count is 1 on allocation and decremented by free. Setting the key object in an operation context increments the reference und unsetting the key object in an oparation context or freeing the operation context decrements the reference count. The key object is destroyed if oand only if the reference count is 0. Key objects may be shared among multiple threads. </p>

<p class="definition">Definition in file <a class="el" href="aes__key_8h_source.html">aes_key.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a060807b5c1a43188e0cd2b1c2548ef33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060807b5c1a43188e0cd2b1c2548ef33">&#9670;&nbsp;</a></span>zpc_aes_key_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_alloc </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key **&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new AES key object with reference count 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a7bc19039829832313f84217ddbc12370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bc19039829832313f84217ddbc12370">&#9670;&nbsp;</a></span>zpc_aes_key_set_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_set_size </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AES key size.</p>
<p>The key size cannot be changed, when the key object is in use (reference count greater than 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>128, 192 or 256 bit key size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="aab53433c4091276a2324860144dfbe86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab53433c4091276a2324860144dfbe86">&#9670;&nbsp;</a></span>zpc_aes_key_set_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_set_type </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AES key type.</p>
<p>The key type cannot be changed, when the key object is in use (reference count greater than 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>ZPC_AES_KEY_TYPE_CCA_DATA, ZPC_AES_KEY_TYPE_CCA_CIPHER or ZPC_AES_KEY_TYPE_EP11 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a700366ec1d545c1264c3290b77656f3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a700366ec1d545c1264c3290b77656f3c">&#9670;&nbsp;</a></span>zpc_aes_key_set_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_set_flags </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AES key flags.</p>
<p>The flags have a key type specific meaning and provide a fine grained control of the kernel's key generation ioctls. For a detailed description of the ioctls and the flags, see kernel's arch/s390/include/uapi/asm/pkey.h.</p>
<p>The key flags cannot be changed, when the key object is in use (reference count greater than 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>key flags </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a2bd77ac0413bfdd1a53806ee9d029e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd77ac0413bfdd1a53806ee9d029e54">&#9670;&nbsp;</a></span>zpc_aes_key_set_mkvp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_set_mkvp </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mkvp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AES key Master Key Verification Pattern.</p>
<p>Associate all APQNs that match the given MKVP with the key object. Overrides the key object's present APQN settings.</p>
<p>The MKVP cannot be changed, when the key object is in use (reference count greater than 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mkvp</td><td>master key verification pattern </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a586a8189aa3fbc55163080dbdc874fc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a586a8189aa3fbc55163080dbdc874fc3">&#9670;&nbsp;</a></span>zpc_aes_key_set_apqns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_set_apqns </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>apqns</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AES key APQNs.</p>
<p>Associate all giveb APQNs with the key object, Overrides the key object's present APQN settings.</p>
<p>The APQNs cannot be changed, when the key object is in use (reference count greater than 1).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">apqns</td><td>NULL-terminated APQN list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a6148f9aeabe72be78ecbef205c0f04fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6148f9aeabe72be78ecbef205c0f04fb">&#9670;&nbsp;</a></span>zpc_aes_key_import()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_import </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>seckeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an AES secure-key.</p>
<p>The imported key must match the key object's key type, size and APQN settings.</p>
<p>No secure-key can be imported, when the key object is in use (reference count greater than 1).</p>
<p>The corresponding protected key is automatically derived.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seckey</td><td>AES secure-key buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seckeylen</td><td>AES key secure-length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a64327ae37920bc387bbddc844a726015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64327ae37920bc387bbddc844a726015">&#9670;&nbsp;</a></span>zpc_aes_key_import_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_import_clear </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>clrkey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an AES clear-key.</p>
<p>The imported key must match the key object's key size setting.</p>
<p>No clear-key can be imported, when the key object is in use (reference count greater than 1).</p>
<p>The corresponding secure/protected key pair is automatically derived.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clearkey</td><td>AES clear-key buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a317025b1b138b377abb13c64a43e8beb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a317025b1b138b377abb13c64a43e8beb">&#9670;&nbsp;</a></span>zpc_aes_key_export()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_export </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>seckeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export an AES secure-key.</p>
<p>If the secure-key buffer is NULL, the byte-length of the secure-key is returned in the secure-key length argument.</p>
<p>If the secure-key buffer is non-NULL and the secure-key length argument is greater than or equal to the secure-key's byte-length, the secure key is returned in the secure-key buffer. The byte-length of the secure-key is returned in the secure-key length argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">seckey</td><td>AES secure-key buffer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seckeylen</td><td>AES secure-key length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a601fb4f7adbaaf3652d672b54753d91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a601fb4f7adbaaf3652d672b54753d91d">&#9670;&nbsp;</a></span>zpc_aes_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_generate </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate a random AES secure/protected key pair or a random protected key.</p>
<p>If there are no APQNs associated with the key object, a random protected key is generated. Otherwise, a random secure key is generated and the corresponding protected key is automatically derived.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a9fb5f3ca58ece71be02605ce6759ef84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb5f3ca58ece71be02605ce6759ef84">&#9670;&nbsp;</a></span>zpc_aes_key_reencipher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_key_reencipher </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reenc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reencipher an AES secure-key with another master key.</p>
<p>Secure-keys of type ZPC_AES_KEY_TYPE_EP11 only support ZPC_AES_KEY_REENCIPHER_CURRENT_TO_NEW. The corresponding protected key is automatically derived.</p>
<p>A backup of the prevous secure/protected key pair is kept in case the new secure/protected key pair is not usable yet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reenc</td><td>ZPC_AES_KEY_REENCIPHER_OLD_TO_CURRENT or ZPC_AES_KEY_REENCIPHER_CURRENT_TO_NEW </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a69f31fc142e4e83ad7d08b2a454a73fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f31fc142e4e83ad7d08b2a454a73fa">&#9670;&nbsp;</a></span>zpc_aes_key_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zpc_aes_key_free </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_key **&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrease the reference count of an AES key object and free it the count reaches 0.</p>
<p>Set the key object argument to NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>AES key object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
